<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc1034 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.1034.xml">
<!ENTITY rfc2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY rfc2136 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2136.xml">
<!ENTITY rfc2317 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2317.xml">
<!ENTITY rfc3007 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3007.xml">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc autobreaks="yes"?>
<?rfc docmapping="yes"?>

<rfc category="std" docName="draft-spacek-dnsop-update-clarif-00"
      ipr="trust200902">
  <front>
    <title abbrev="DNS UPDATE clarifications">Clarifications to the Classless IN-ADDR.ARPA Delegation</title>

    <author fullname="Petr Spacek" initials="P." surname="Spacek">
      <organization>Red Hat, Inc.</organization>
      <address><email>pspacek@redhat.com</email></address>
    </author>

    <date month="June" year="2015" />

    <area>Operations and Management</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <abstract>
			<t>TODO:
			This document clarifies interaction among Dynamic Updates
			in the Domain Name System (DNS UPDATE), Classless IN-ADDR.ARPA delegation,
			and Secure Domain Name System (DNS) Dynamic Update.
      </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
			<t>This document clarifies interaction among Dynamic Updates
				in the Domain Name System (DNS UPDATE) <xref target="RFC2136"/>, Classless IN-ADDR.ARPA delegation <xref target="RFC2317"/>,
				and Secure Domain Name System (DNS) Dynamic Update <xref target="RFC3007"/>.</t>

			<t>It was identified that common implementations using DNS update protocol
				often ignore existence of CNAME/DNAME redirections and as a result
				fail to update records if a redirection is used. One common example is
				failure to update PTR	records in classless IN-ADDR.ARPA	zones.</t>

			<t><xref target="RFC2317"/> describes how to use CNAME records in IN-ADDR.ARPA DNS zones to split
				administrative control over IN-ADDR.ARPA data for classless networks. The described method is perfectly
				compatible with standard DNS resolution but DNS update requests
				need special handling described in this document.</t>

			<t anchor="applicability">This clarification is applicable to parties wanting to update records
				in IN-ADDR.ARPA and other zones without changing existing CNAME/DNAME
				redirections. An typical example are PTR record updates in zones
				which might potentially use <xref target="RFC2317"/>.
				This clarification is not applicable to cases where aim of the DNS update
				is to change CNAME/DNAME redirection.</t>

		</section>

    <section title="Document Conventions">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref
			target="RFC2119"/>.</t>

			<t>Terms "requestor", "update message", and names of update message's sections are
				used in the same sense as in <xref target="RFC2136"/>.</t>

			<t>Examples involving IN-ADDR.ARPA zone and PTR records are referring to <xref target="RFC2317"/>.</t>
    </section>

    <section title="Problem Description">
			<t>Problem described herein typically occurs when an implementation intends
				to update resource records resolvable using particular owner name
				while keeping all CNAME/DNAME redirections intact. In other words,
				aim of the update is to change resource records associated with
			  terminal node of (potential) chain of redirections starting at
				a known owner name.</t>
				
			<t>Typically this is the case if the resource records are associated
				with well-known owner name, or an owner name which is derived from
				data obtained by means outside of DNS. For example, implementations
				often translate IPv4 address to DNS owner	name using algorithm
				from <xref target="RFC1034"/> section 5.2.1.4:</t>

			<figure> <!--anchor="fig-ipv42name"> -->
          <artwork><![CDATA[
192.0.2.1 -> 2.0.192.in-addr.arpa.
]]></artwork>
        </figure>

			<t>The problem is that implementations often use this original node name
				in Update Message without checking for redirections.
				If the original owner name contains redirection then this behavior
				results in an attempt to add or delete another record to or from a node which already contains
				CNAME record and the update fails.</t>

			<t>Such naively constructed update request will be silently ignored
				in accordance with <xref target="RFC2136"/> section 3.4.2.2. Alternatively,
				an error will be reported	to the requestor if he added non-existence
				of CNAME record as prerequisite	to the Update Message.</t>
		</section>

    <section title="Clarification to Requestor Behaviour">
			<t>Please see <xref target="applicability">applicability note in Introduction</xref>.</t>

			<t>A Requestor MUST resolve (canonicalize) the original owner name (e.g. one derived from IPv4 address) to a canonical owner name before constructing the Update Message. The requestor MUST follow whole chain of redirections until the terminal node of the chain is reached and use canonical name found at the terminal node. Implementations MUST detect infinite loops.</t>

			<t>Canonical owner name MUST be used instead of the original owner name in the resulting Update Message:
				<list style="symbols">
					<t>All names used in Prerequisite and Update sections MUST be canonicalized as specified above. Only prerequisites concerning CNAME or DNAME records are exception to this rule and should not be canonicalized.</t>
					<t>ZNAME in Zone Section has to contain name of the zone enclosing the canonical owner names.</t>
					<t>Implementation MAY chose to use canonicalized names in RDATA and Additional Section. This is application specific decision.</t>
				</list>
			</t>
    </section>


    <section title="IANA Considerations">
      <t>This draft does not involve IANA Considerations.</t>
    </section>

    <section title="Security Considerations">
			<t>TODO:
			Canonicalization allows the active attacker to redirect the update
			to a node of his choice. Update authentication using TSIG or other means
			should allow clients to modify only minimal set nodes to prevent attacker
			from modifying other nodes.</t>
    </section>

  </middle>

  <back>
<?rfc rfcedstyle="no"?>
    <references title="Normative References">
      &rfc1034;
      &rfc2119;
      &rfc2136;
      &rfc2317;
      &rfc3007;
    </references>
  </back>
</rfc>

